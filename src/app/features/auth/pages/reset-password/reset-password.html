<div class="reset-page-container">
  <p-card class="reset-card">
    <div class="card-content">
      <div class="reset-form-container">
        <div class="reset-header">
          <app-logo-image />
          <h1>Restablecer Contraseña</h1>
          <p class="subtitle">Ingresa tu nueva contraseña</p>
        </div>

        <div class="reset-content">
          <form [formGroup]="resetForm" (ngSubmit)="onSubmit()">
            <div class="field">
              <p-floatlabel variant="on">
                <p-password
                  id="password"
                  formControlName="password"
                  [feedback]="true"
                  [toggleMask]="true"
                  autocomplete="new-password"
                  [style]="{ width: '100%' }"
                  promptLabel="Ingresa tu nueva contraseña"
                  weakLabel="Contraseña débil"
                  mediumLabel="Contraseña media"
                  strongLabel="Contraseña fuerte"
                  autofocus=""
                  fluid
                />
                <label for="password">Nueva Contraseña</label>
              </p-floatlabel>
              @if (isInvalid('password')) {
              <ng-container
                [ngTemplateOutlet]="alerta"
                [ngTemplateOutletContext]="{ fieldName: 'password' }"
              />
              }
            </div>

            <div class="field">
              <p-floatlabel variant="on">
                <p-password
                  id="confirmPassword"
                  formControlName="confirmPassword"
                  [feedback]="false"
                  [toggleMask]="true"
                  autocomplete="new-password"
                  [style]="{ width: '100%' }"
                  fluid
                />
                <label for="confirmPassword">Confirmar Contraseña</label>
              </p-floatlabel>
              @if (isInvalid('confirmPassword')) {
              <ng-container
                [ngTemplateOutlet]="alerta"
                [ngTemplateOutletContext]="{ fieldName: 'confirmPassword' }"
              />
              }
            </div>

            <div class="button-container">
              <p-button
                type="submit"
                [rounded]="true"
                severity="primary"
                [disabled]="resetForm.invalid || isResetting()"
                styleClass="reset-button"
                fluid
              >
                @if (isResetting()) {
                <zoo-loader
                  [size]="20"
                  [color]="'var(--p-primary-contrast-color)'"
                />
                } @else { Restablecer Contraseña }
              </p-button>
            </div>
          </form>

          <div class="login-link">
            ¿Recordaste tu contraseña? <a routerLink="/login">Inicia sesión</a>
          </div>
        </div>
      </div>
    </div>
  </p-card>
</div>

<ng-template #alerta let-fieldName="fieldName">
  <p-message severity="error" variant="simple" size="small">
    {{ getErrorMessage(fieldName) }}
  </p-message>
</ng-template>
